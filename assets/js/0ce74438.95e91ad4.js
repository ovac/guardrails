/*! For license information please see 0ce74438.95e91ad4.js.LICENSE.txt */
"use strict";(self.webpackChunkguardrails_docs=self.webpackChunkguardrails_docs||[]).push([[3365],{467:(e,t,r)=>{function n(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,l,"next",e)}function l(e){n(a,o,i,s,l,"throw",e)}s(void 0)})}}r.d(t,{A:()=>o})},2444:(e,t,r)=>{function n(e,t,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,r,o){function a(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},n(e,t,r,o)}function o(){var e,t,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function s(r,o,i,a){var s=o&&o.prototype instanceof u?o:u,c=Object.create(s.prototype);return n(c,"_invoke",function(r,n,o){var i,a,s,u=0,c=o||[],p=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return i=t,a=0,s=e,d.n=r,l}};function f(r,n){for(a=r,s=n,t=0;!p&&u&&!o&&t<c.length;t++){var o,i=c[t],f=d.p,m=i[2];r>3?(o=m===n)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=f&&((o=r<2&&f<i[1])?(a=0,d.v=n,d.n=i[1]):f<m&&(o=r<3||i[0]>n||n>m)&&(i[4]=r,i[5]=n,d.n=m,a=0))}if(o||r>1)return l;throw p=!0,n}return function(o,c,m){if(u>1)throw TypeError("Generator is already running");for(p&&1===c&&f(c,m),a=c,s=m;(t=a<2?e:s)||!p;){i||(a?a<3?(a>1&&(d.n=-1),f(a,s)):d.n=s:d.v=s);try{if(u=2,i){if(a||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((t=(p=d.n<0)?s:r.call(n,d))!==l)break}catch(t){i=e,a=1,s=t}finally{u=1}}return{value:t,done:p}}}(r,i,a),!0),c}var l={};function u(){}function c(){}function p(){}t=Object.getPrototypeOf;var d=[][i]?t(t([][i]())):(n(t={},i,function(){return this}),t),f=p.prototype=u.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,n(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=p,n(f,"constructor",p),n(p,"constructor",c),c.displayName="GeneratorFunction",n(p,a,"GeneratorFunction"),n(f),n(f,a,"Generator"),n(f,i,function(){return this}),n(f,"toString",function(){return"[object Generator]"}),(o=function(){return{w:s,m:m}})()}r.d(t,{A:()=>o})},9940:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var n=r(1656),o=r(1107),i=r(2444),a=r(467),s=r(6540),l=r(4848),u={twoPerson:{label:"Two-person rule for publishing",description:"Author plus one peer for publishing a post.",defaults:{includeInitiator:!0,approvalsRequired:2,permissions:"content.publish",roles:"",stepName:"Editorial Review",guardAttribute:"published"}},escalation:{label:"Escalating approvals across teams",description:"Support lead then security officer for destructive actions.",defaults:{includeInitiator:!1,approvalsRequired:1,permissions:"",roles:"support_lead,security_officer",stepName:"Escalated Approval",guardAttribute:"status"}},anyOf:{label:"Flexible any-of roles",description:"Allow one of many operations managers to approve refunds.",defaults:{includeInitiator:!1,approvalsRequired:1,permissions:"",roles:"finance_manager,ops_manager",stepName:"Management Approval",guardAttribute:"refunded"}}};function c(){var e=(0,s.useState)("twoPerson"),t=e[0],r=e[1],n=(0,s.useState)(u.twoPerson.defaults),o=n[0],c=n[1],p=(0,s.useState)(!1),d=p[0],f=p[1],m=(0,s.useMemo)(function(){return function(e,t){var r=e.permissions.split(",").map(function(e){return e.trim()}).filter(Boolean),n=e.roles.split(",").map(function(e){return e.trim()}).filter(Boolean),o=["Flow::make()",r.length?"    ->anyOfPermissions(["+r.map(function(e){return"'"+e+"'"}).join(", ")+"])":null,n.length?"    ->anyOfRoles(["+n.map(function(e){return"'"+e+"'"}).join(", ")+"])":null,e.includeInitiator?"    ->includeInitiator(true, true)":null,"    ->toStep("+e.approvalsRequired+", '"+e.stepName+"')","    ->build();"].filter(Boolean);if("escalation"===t&&n.length>=2){var i=n[0],a=n[1];o.splice(1,0,"    ->anyOfRoles(['"+i+"'])"),o.splice(3,0,"    ->toStep(1, '"+e.stepName+" - Level 1')"),o.splice(4,0,"    ->anyOfRoles(['"+a+"'])"),o.splice(5,0,"    ->toStep(1, '"+e.stepName+" - Level 2')"),o.splice(o.indexOf("    ->build();"),0,"    // append more ->anyOfRoles()->toStep() as needed")}return"use OVAC\\Guardrails\\Concerns\\ActorGuarded;\nuse OVAC\\Guardrails\\Services\\Flow;\n\nclass ExampleModel extends Model\n{\n    use ActorGuarded;\n\n    protected array $guarded = ['id'];\n\n    public function humanGuardAttributes(): array\n    {\n        return ['"+e.guardAttribute+"'];\n    }\n\n    public function actorApprovalFlow(array $dirty, string $event): array\n    {\n        return [\n"+o.map(function(e){return"            "+e}).join("\n")+"\n        ];\n    }\n}\n"}(o,t)},[o,t]);function h(e,t){c(function(r){var n;return Object.assign({},r,((n={})[e]=t,n))})}function v(){return(v=(0,a.A)((0,i.A)().m(function e(){return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,navigator.clipboard.writeText(m);case 1:f(!0),setTimeout(function(){return f(!1)},1600);case 2:return e.a(2)}},e)}))).apply(this,arguments)}return(0,l.jsxs)("div",{className:"playgroundCard",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"template",children:"Scenario"}),(0,l.jsx)("select",{id:"template",className:"margin-top--xs",value:t,onChange:function(e){var t=e.target.value;r(t),c(u[t].defaults)},children:Object.entries(u).map(function(e){var t=e[0],r=e[1];return(0,l.jsx)("option",{value:t,children:r.label},t)})}),(0,l.jsx)("p",{className:"margin-top--sm",children:u[t].description})]}),(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsx)("label",{htmlFor:"permissions",children:"Permissions (comma separated)"}),(0,l.jsx)("input",{id:"permissions",type:"text",value:o.permissions,onChange:function(e){return h("permissions",e.target.value)}})]}),(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsx)("label",{htmlFor:"roles",children:"Roles (comma separated)"}),(0,l.jsx)("input",{id:"roles",type:"text",value:o.roles,onChange:function(e){return h("roles",e.target.value)}})]})]}),(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsx)("label",{htmlFor:"approvalsRequired",children:"Approvals required in step"}),(0,l.jsx)("input",{id:"approvalsRequired",type:"number",min:1,max:5,value:o.approvalsRequired,onChange:function(e){return h("approvalsRequired",Number(e.target.value))}})]}),(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsx)("label",{htmlFor:"stepName",children:"Step label"}),(0,l.jsx)("input",{id:"stepName",type:"text",value:o.stepName,onChange:function(e){return h("stepName",e.target.value)}})]})]}),(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsx)("label",{htmlFor:"guardAttribute",children:"Guarded attribute"}),(0,l.jsx)("input",{id:"guardAttribute",type:"text",value:o.guardAttribute,onChange:function(e){return h("guardAttribute",e.target.value)}})]}),(0,l.jsx)("div",{className:"col col--6",style:{display:"flex",alignItems:"flex-end",gap:"0.5rem"},children:(0,l.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,l.jsx)("input",{type:"checkbox",checked:o.includeInitiator,onChange:function(e){return h("includeInitiator",e.target.checked)}}),"Count initiator as signer"]})})]}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{className:"button button--primary",type:"button",onClick:function(){return v.apply(this,arguments)},children:d?"Copied!":"Copy snippet"})}),(0,l.jsx)("pre",{children:(0,l.jsx)("code",{children:m})})]})}function p(){return(0,l.jsx)(n.A,{title:"Playground",description:"Interactive Guardrails flow builder and code generator.",children:(0,l.jsx)("main",{className:"container margin-vert--xl",children:(0,l.jsx)("div",{className:"row",children:(0,l.jsxs)("div",{className:"col col--10 col--offset-1",children:[(0,l.jsx)(o.A,{as:"h1",children:"Guardrails Playground"}),(0,l.jsx)("p",{children:"Prototype flows without editing code. Tweak the parameters below to generate PHP snippets you can drop directly into your models or controllers. The Playground keeps everything client side so you can experiment freely."}),(0,l.jsx)(c,{})]})})})})}}}]);