"use strict";(self.webpackChunkguardrails_docs=self.webpackChunkguardrails_docs||[]).push([[7624],{28453:(e,s,r)=>{r.d(s,{R:()=>o,x:()=>d});var t=r(96540);const i={},n=t.createContext(i);function o(e){const s=t.useContext(n);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(n.Provider,{value:s},e.children)}},46439:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"api","title":"API Reference","description":"Endpoints for listing, approving, and rejecting requests.","source":"@site/docs/api.md","sourceDirName":".","slug":"/api","permalink":"/guardrails/docs/next/api","draft":false,"unlisted":false,"editUrl":"https://github.com/ovac/guardrails/edit/main/resources/docs/docs/api.md","tags":[{"inline":true,"label":"api","permalink":"/guardrails/docs/next/tags/api"},{"inline":true,"label":"http","permalink":"/guardrails/docs/next/tags/http"}],"version":"current","frontMatter":{"title":"API Reference","description":"Endpoints for listing, approving, and rejecting requests.","tags":["api","http"]},"sidebar":"docs","previous":{"title":"Voting Models","permalink":"/guardrails/docs/next/voting-models"},"next":{"title":"Auditing & Changelog","permalink":"/guardrails/docs/next/auditing-and-changelog"}}');var i=r(74848),n=r(28453);const o={title:"API Reference",description:"Endpoints for listing, approving, and rejecting requests.",tags:["api","http"]},d="API Reference",l={},c=[{value:"GET /{route_prefix}",id:"get-route_prefix",level:2},{value:"POST /{route_prefix}/{request}/steps/{step}/approve",id:"post-route_prefixrequeststepsstepapprove",level:2},{value:"POST /{route_prefix}/{request}/steps/{step}/reject",id:"post-route_prefixrequeststepsstepreject",level:2}];function a(e){const s={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"api-reference",children:"API Reference"})}),"\n",(0,i.jsx)(s.h2,{id:"get-route_prefix",children:"GET /{route_prefix}"}),"\n",(0,i.jsxs)(s.p,{children:["List pending approval requests visible to the authenticated user. Default prefix: ",(0,i.jsx)(s.code,{children:"guardrails/api"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Notes:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Results are filtered server-side so users only see requests they initiated, have already signed, or are eligible to sign."}),"\n",(0,i.jsxs)(s.li,{children:["Each ",(0,i.jsx)(s.code,{children:"steps"})," entry now includes signer metadata so UIs can show who qualifies:","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"permissions_required"})," \u2014 array of permission strings configured for the step."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"permissions_mode"})," \u2014 ",(0,i.jsx)(s.code,{children:"all"})," or ",(0,i.jsx)(s.code,{children:"any"})," matching the flow configuration."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"roles_required"})," \u2014 array of role slugs that satisfy the step."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"roles_mode"})," \u2014 ",(0,i.jsx)(s.code,{children:"all"})," or ",(0,i.jsx)(s.code,{children:"any"})," for the associated roles."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Query params:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"per_page"}),": integer, default 25, max 100."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"post-route_prefixrequeststepsstepapprove",children:"POST /{route_prefix}/{request}/steps/{step}/approve"}),"\n",(0,i.jsx)(s.p,{children:"Approve a step for the current authenticated user on the configured guard."}),"\n",(0,i.jsx)(s.p,{children:"Body params:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"comment"}),": optional string (max 1000)."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Auth & Policy:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Requires ",(0,i.jsx)(s.code,{children:"auth:\\{guard\\}"})," where ",(0,i.jsx)(s.code,{children:"\\{guard\\}"})," defaults to ",(0,i.jsx)(s.code,{children:"auth.defaults.guard"})," (usually ",(0,i.jsx)(s.code,{children:"web"}),") and the ",(0,i.jsx)(s.code,{children:"guardrails.permissions.sign"})," ability. The user must satisfy the step\u2019s signer policy (permissions/roles)."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"post-route_prefixrequeststepsstepreject",children:"POST /{route_prefix}/{request}/steps/{step}/reject"}),"\n",(0,i.jsxs)(s.p,{children:["Record a rejection for the current step. Guardrails keeps the step pending until the configured rejection threshold is met (defaults to a simple majority of the approval threshold). Once the threshold is satisfied the step and request transition to ",(0,i.jsx)(s.code,{children:"rejected"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Body params:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"comment"}),": optional string (max 1000) recorded on the rejection signature."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Auth & Policy:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Same guard and ability requirements as the approve endpoint. The authenticated user must satisfy the signer policy for the step in order to reject it."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Response body includes:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"rejected"})," \u2014 Boolean indicating whether the step transitioned to the rejected state after this signature."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"rejections.count"})," \u2014 Rejections recorded so far."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"rejections.required"})," \u2014 Minimum rejections required to fail the step (defaults to majority if not explicitly set in the flow builder)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"rejections.maximum"})," \u2014 Optional hard-stop when configured via the flow builder."]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);