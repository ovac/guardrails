"use strict";(self.webpackChunkguardrails_docs=self.webpackChunkguardrails_docs||[]).push([[5352],{28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>t});var s=r(96540);const i={},o=s.createContext(i);function a(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(o.Provider,{value:n},e.children)}},40760:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"configuration","title":"configuration","description":"title: Configuration Reference","source":"@site/versioned_docs/version-1.0.1-alpha-1/configuration.md","sourceDirName":".","slug":"/configuration","permalink":"/guardrails/docs/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/ovac/guardrails/edit/main/resources/docs/versioned_docs/version-1.0.1-alpha-1/configuration.md","tags":[],"version":"1.0.1-alpha-1","frontMatter":{},"sidebar":"docs","previous":{"title":"Getting Started","permalink":"/guardrails/docs/getting-started"},"next":{"title":"FAQ","permalink":"/guardrails/docs/faq"}}');var i=r(74848),o=r(28453);const a={},t="Configuration Reference",l={},d=[{value:"Authentication helper",id:"authentication-helper",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"title: Configuration Reference\ndescription: Detailed explanation of every config option with defaults."}),"\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"configuration-reference",children:"Configuration Reference"})}),"\n",(0,i.jsx)(n.p,{children:"Publish the config file and review available options:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'php artisan vendor:publish --provider="OVAC\\\\Guardrails\\\\GuardrailsServiceProvider" --tag=guardrails-config\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Default config: ",(0,i.jsx)(n.code,{children:"config/guardrails.php"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"return [\n    /*\n    |--------------------------------------------------------------------------\n    | Authentication\n    |--------------------------------------------------------------------------\n    | Choose which Laravel auth guard represents your reviewers/approvers.\n    | Defaults to your application's auth.defaults.guard (typically 'web').\n    */\n    'auth' => [\n        'guard' => env('GUARDRAILS_AUTH_GUARD', config('auth.defaults.guard', 'web')),\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | API Routes\n    |--------------------------------------------------------------------------\n    |\n    | Configure the API endpoint under which Guardrails exposes its endpoints\n    | and the middleware stack protecting those routes.\n    |\n    */\n    'route_prefix' => env('GUARDRAILS_ROUTE_PREFIX', 'guardrails/api'),\n\n    /*\n    | The middleware stack for API routes.\n    */\n    'middleware' => [\n        'api', 'auth:'.env('GUARDRAILS_AUTH_GUARD', config('auth.defaults.guard', 'web')),\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Web Page\n    |--------------------------------------------------------------------------\n    |\n    | Configure the browser-facing page (a minimal UI bundled by the package)\n    | and the middleware stack protecting it.\n    |\n    */\n    'page_prefix' => env('GUARDRAILS_PAGE_PREFIX', 'guardrails'),\n\n    /*\n    | The middleware stack for the web page route.\n    */\n    'web_middleware' => ['web', 'auth:'.env('GUARDRAILS_AUTH_GUARD', config('auth.defaults.guard', 'web'))],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Views\n    |--------------------------------------------------------------------------\n    |\n    | You may optionally specify a layout name and the section where the\n    | bundled view should inject its content.\n    |\n    */\n    'views' => [\n        // Parent layout view name, or null to render the standalone Guardrails UI\n        'layout' => env('GUARDRAILS_LAYOUT', null),\n        // Section name inside the layout to yield content to\n        'section' => env('GUARDRAILS_SECTION', 'content'),\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Permissions\n    |--------------------------------------------------------------------------\n    |\n    | Abilities checked before viewing approval requests or signing steps.\n    | These should map to your authorization layer (e.g. Spatie permissions).\n    |\n    */\n    'permissions' => [\n        // View the approvals dashboard or list via API\n        'view' => 'approvals.manage',\n        // Approve or sign a step\n        'sign' => 'approvals.manage',\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Signing Policy\n    |--------------------------------------------------------------------------\n    |\n    | Customize how Guardrails resolves role membership when evaluating signer\n    | rules. Provide a closure that receives the authenticated user and returns\n    | an array of role identifiers, or leave null to use built-in fallbacks.\n    |\n    */\n    'signing' => [\n        'resolve_roles_using' => null,\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Controller Interceptor\n    |--------------------------------------------------------------------------\n    |\n    | Toggle for the controller helper that routes mutations through Guardrails\n    | when enabled (see InteractsWithGuardrail trait).\n    |\n    */\n    'controller' => [\n        'enabled' => env('GUARDRAILS_CONTROLLER_ENABLED', true),\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Configurable Approval Flows (Controller Interceptor)\n    |--------------------------------------------------------------------------\n    |\n    | Optional overrides for controller-level flows. Keys map to\n    | guardrails.flows.<feature>.<action>. Each value is an array of steps\n    | shaped like FlowBuilder output (signers, threshold, meta).\n    |\n    | Example:\n    | 'flows' => [\n    |     'orders' => [\n    |         'approve' => [\n    |             [\n    |                 'name' => 'Risk Review',\n    |                 'threshold' => 1,\n    |                 'signers' => [\n    |                     'guard' => 'web',\n    |                     'permissions' => ['orders.approve'],\n    |                     'permissions_mode' => 'any',\n    |                     'roles' => [],\n    |                     'roles_mode' => 'all',\n    |                 ],\n|                 'meta' => [\n|                     'include_initiator' => false,\n|                     'preapprove_initiator' => true,\n|                     'hint' => 'Ops review before approving.',\n|                 ],\n|             ],\n|         ],\n|     ],\n| ],\n*/\n'flows' => [\n    // empty by default; opt in per feature/action\n],\n\n// You can also flatten the key if you prefer:\n// 'flows' => [\n//     'orders.approve' => [\n//         ['name' => 'Risk Review', 'threshold' => 1, 'signers' => [...], 'meta' => []],\n//     ],\n// ],\n// Single-step shorthand (no double brackets) is also allowed:\n// 'flows' => [\n//     'orders.approve' => [\n//         'name' => 'Risk Review',\n//         'threshold' => 1,\n//         'signers' => ['guard' => 'web', 'permissions' => ['orders.approve']],\n//     ],\n// ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Support & Sponsorship\n    |--------------------------------------------------------------------------\n    |\n    | When enabled, the package prints a short one-time message in the\n    | console after installation (first artisan run) asking users to star\n    | the repo or sponsor. You can disable this if undesired.\n    |\n    */\n    'support' => [\n        'motd' => env('GUARDRAILS_SUPPORT_MOTD', true),\n        'github_repo' => 'ovac/guardrails',\n        'github_sponsor' => 'ovac4u',\n    ],\n];\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"guardrailFlow('<feature>.<action>', $fallback, ['summary' => '...'])"})," in your controllers to read ",(0,i.jsx)(n.code,{children:"guardrails.flows"})," entries. Config values win when present, otherwise your fallback is used, and the meta defaults merge onto every step."]}),"\n",(0,i.jsx)(n.p,{children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"auth.guard"}),": Defaults to ",(0,i.jsx)(n.code,{children:"auth.defaults.guard"})," (usually ",(0,i.jsx)(n.code,{children:"web"}),"). Set ",(0,i.jsx)(n.code,{children:"GUARDRAILS_AUTH_GUARD"})," or edit the config if approvals should use another guard (e.g. ",(0,i.jsx)(n.code,{children:"sanctum"}),", ",(0,i.jsx)(n.code,{children:"api"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"route_prefix"}),": Base path for the JSON API; adjust to match your application's namespace."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"middleware"}),": Guardrails defaults to ",(0,i.jsx)(n.code,{children:"['api','auth:\\{guard\\}"}),"]. Replace or extend this array to match your middleware stack."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"page_prefix"}),": Browser-facing route for the review UI."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"views.layout"})," / ",(0,i.jsx)(n.code,{children:"views.section"}),": Provide a layout if you want the bundled page to yield into your app shell. Leave ",(0,i.jsx)(n.code,{children:"layout"})," ",(0,i.jsx)(n.code,{children:"null"})," to serve the standalone UI, or keep it ",(0,i.jsx)(n.code,{children:"null"})," and include ",(0,i.jsx)(n.code,{children:"@include('guardrails::panel')"})," wherever you want the panel to appear inside your own view."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"permissions.view"})," and ",(0,i.jsx)(n.code,{children:"permissions.sign"}),": Abilities consulted by the routes and UI (map to your policy layer)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"flows"}),": Optional controller overrides keyed as ",(0,i.jsx)(n.code,{children:"<feature>.<action>"})," (e.g., ",(0,i.jsx)(n.code,{children:"orders.approve"}),"). Pull them in with ",(0,i.jsx)(n.code,{children:"guardrailFlow('orders.approve', $fallback, ['summary' => 'Order #'.$order->id])"}),"; config wins when present, otherwise the fallback is used, and meta defaults are merged onto every step."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"signing.resolve_roles_using"}),": Supply a closure if you need to resolve roles from a custom source (see ",(0,i.jsx)(n.a,{href:"/guardrails/docs/signing-policy",children:"Signing Policy Reference"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"authentication-helper",children:"Authentication helper"}),"\n",(0,i.jsxs)(n.p,{children:["Guardrails ships a small helper (",(0,i.jsx)(n.code,{children:"OVAC\\\\Guardrails\\\\Support\\\\Auth"}),") that centralizes guard resolution:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Auth::guardName()"})," returns the configured guard, falling back to ",(0,i.jsx)(n.code,{children:"auth.defaults.guard"})," or ",(0,i.jsx)(n.code,{children:"web"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Auth::guard()"})," resolves the framework guard instance."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Auth::user()"})," / ",(0,i.jsx)(n.code,{children:"Auth::check()"})," mirror Laravel\u2019s helpers but respect the Guardrails configuration."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Auth::providerModelClass()"})," and ",(0,i.jsx)(n.code,{children:"Auth::findUserById()"})," resolve users via the guard\u2019s provider, handling both Eloquent models and custom classes."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You can rely on these helpers when writing custom integrations (policies, events) so your code stays in sync with the guard Guardrails uses."}),"\n",(0,i.jsx)(n.p,{children:"Additional options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"controller.enabled"}),": Gate the controller helper so you can opt-out globally during development or certain environments."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"support.*"}),": Controls the one-time console message asking teams to star or sponsor the package."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);